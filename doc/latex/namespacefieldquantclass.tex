\hypertarget{namespacefieldquantclass}{}\section{fieldquantclass Module Reference}
\label{namespacefieldquantclass}\index{fieldquantclass@{fieldquantclass}}


This class defines a 3-\/D field quantity in the accelerator. The field quantity can be updated at each step.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a02f323941fc76278b26a3aa06fa3bbdd}{construct\+\_\+fieldquant}} (this, innx, inny, innz, geom, grid)
\begin{DoxyCompactList}\small\item\em Initialize field class. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a2d6cd3fb8b4d962adbd4206a5fbd13ce}{set\+\_\+fieldquant}} (this, innx, inny, innz, geom, grid, nprx, npry)
\begin{DoxyCompactList}\small\item\em set field quantity. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a1424ab249c01287bbfe998370d2c5703}{gradeb\+\_\+fieldquant}} (innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, gammaz, Flag\+Image, egxout, egyout, egzout, bgxout, bgyout, bgzout)
\begin{DoxyCompactList}\small\item\em find the E and B fields in the lab frame from the potential on the grid of beam frame. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a06d0461c3c52859b9fa8b0c4d5f0db46}{update3otnew\+\_\+fieldquant}} (this, source, fldgeom, grid, nxlc
\begin{DoxyCompactList}\small\item\em update potential (solving Possion\textquotesingle{}s equation) with 3D isolated boundary conditions. Here, image charge potential along z also calculated \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_aae4177005bffdb768a50a98b860c111a}{openbc3dnew}} (innx, inny, innz, rho, hx, hy, hz, nxpylc2, nypzlc2, myidz, myidy, npz, npy, commrow, commcol, comm2d, pztable, pytable, ypzstable, xpystable, inxglb, inyglb, inzglb, rho\+Img, flag\+Image, zshift)
\begin{DoxyCompactList}\small\item\em Solving Poisson\textquotesingle{}s equation with open B\+Cs. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a32715398e47b9a73bd6cde1ae980e0a3}{greenf1tintnew2}} (nx, ny, nz, nsizez, nsizey, nsizexy, nsizey
\begin{DoxyCompactList}\small\item\em green function for extended array. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a25df6116d62bb56b5711333426dcd74d}{greenf1tintshift2}} (nx, ny, nz, nsizez, nsizey, nsizexy, nsiz
\begin{DoxyCompactList}\small\item\em green function for extended array. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a61fa5f8980736fbc19fa50224214727b}{wakefield\+\_\+fieldquant}} (Nz, xwakez, ywakez, recvdensz, exwake
\begin{DoxyCompactList}\small\item\em longitudinal and transverse wakefield \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_afc918d38222797f1f06903259e48461b}{wakereadin\+\_\+fieldquant}} (Nz, xwakez, ywakez, recvdensz, exwak
\begin{DoxyCompactList}\small\item\em longitudinal and transverse wakefield on a beam using the readin longitudinal and transverse wake functions \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a773b62d57c290818337131902b979b43}{csrwaketr\+\_\+fieldquant}} (Nx, r0, ptmin, hx, blength, rhonew, rh
\begin{DoxyCompactList}\small\item\em new version of the csrwake calculation. this subroutine calculate the 1d csr wakefield including entrance, stead-\/state, and transitions effects here, hx, rho,...are in real unit. the return ezwake is V/m \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a05318a0c571b3210e31af48028673474}{setval\+\_\+fieldquant}} (this, i, j, k, value)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a5d4c07c22ffea0330d90b66e590b24a8}{get\+\_\+fieldquant}} (this, i, j, k)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a2c0b0d0301e9ae5ccd8b2273ffc95ff3}{getglb\+\_\+fieldquant}} (this, temp)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_aa439599c2570610c1c2e0bfacc135603}{getlcgrid\+\_\+fieldquant}} (this, nxlc, nylc, nzlc)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_ae02f70d677d4bedfa6e41bd6cf33d612}{psiroot}} (r0, xx, deltas, psi, eps, Nmax)
\begin{DoxyCompactList}\small\item\em find the psi in equation 12 of Stupakov and Emma\textquotesingle{}s paper \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a4e8922c1e25eef99306f4001c7289ba0}{destruct\+\_\+fieldquant}} (this)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_ac3c0238f350487871fdbe6a84bcdfc2e}{csrwaketrigf\+\_\+fieldquant}} (Nx, r0, ptmin, hx, blength, rhonew
\begin{DoxyCompactList}\small\item\em This subroutine calculates the 1d csr wakefield including entrance, stead-\/state, and transitions effects. Here, hx, rho,...are in real units. The return ezwake is in V! /m. The current version uses I\+GF corresponding to the four cases ! of Saldin et al. \end{DoxyCompactList}\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a7431c26c185c399c546e1ac54043bad4}{icsrcasea}} (phih, ssh, xk2)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_ac6ac81d1607e424c294650bb3f89aa5c}{icsrcaseb}} (ssh, xk2)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a85aac5a4f515439e4263b24518d8c9dc}{icsrcasec}} (phimh, xxbarh, ssh, xk2)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a6e7b51293ed012f0a90b5de96a3cef05}{icsrcased}} (xxbarh, psimax, ssh, xk2, epstol, Nmax)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a990a046cc996cb957a94c4995bfe803a}{dwakefield\+\_\+fieldquant}} (Nx, Ny, Nz, hx, hy, hz, chgdens, dexwak
\begin{DoxyCompactList}\small\item\em This routine computes the root of the function that is evaluated ! in the subroutine \textquotesingle{}funcd\textquotesingle{}. It is based on the subroutine \textquotesingle{}root\textquotesingle{} of Numerical Recipes 9.\+4, which makes use of a Newton-\/\+Raphson method with root bracketing. It has been modified to handle the two bra! cket endpoints carefully. The routine searches for a root in the inter! val \mbox{[}x1,x2\mbox{]} with a tolerance given by \textquotesingle{}xacc\textquotesingle{}, and returns this value as \textquotesingle{}rtsafe\textquotesingle{}. The maximum number of iterations allowed is \textquotesingle{}maxit\textquotesingle{}! . C.\+E.\+M. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a80dd0228de4fecabda6f6696b098a11f}{dwakeconv\+\_\+fieldquant}} (Nz, weightz, hz, kern, lam)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a362a63ffd1dbce47680a0224d88552c7}{dispeqslab\+\_\+fieldquant}} (a, b, eps, dlx, nkx, nky, dkx, dky)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_ac5166a3094bb6567db04903c1f43e4b6}{ampslab\+\_\+fieldquant}} (a, b, eps, nkx, nky, dkx, dky, amp)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_ac9b2b94f5051c235120e16bd55e0148d}{dispeqcyl\+\_\+fieldquant}} (a, b, eps, nkx, nky, dky)
\item 
subroutine \mbox{\hyperlink{namespacefieldquantclass_a0cf12c2453dd024814caca1b9dbbb9a5}{ampcyl\+\_\+fieldquant}} (a, b, eps, nkx, nky, dky, amp)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a3979aaa9ea17b446b00cd5477dfd354e}{func1}} (x, c1, c2)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a1758703e79afc95b20c7fd7261fa4afe}{func2}} (x, c1, c3)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_aaf0193e68163e6fb2bba0a9477f19cb0}{amplsm\+\_\+sym}} (a, b, eps, kx, ky)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_ac67e15255b5d57fb3c3a29ef79addb63}{amplsm\+\_\+asym}} (a, b, eps, kx, ky)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a8eb7b870ec7c240279076fbb6269ff07}{amplse\+\_\+sym}} (a, b, eps, kx, ky)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a735a6d51aabd219f525edeb04b034150}{amplse\+\_\+asym}} (a, b, eps, kx, ky)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a491cfca134ed1bb2dfc47d6de7fdd972}{calclfs}} (s, a, b, eps)
\item 
double precision function \mbox{\hyperlink{namespacefieldquantclass_a765f0fc87c405fa965c6c966794db11c}{calcr0}} (s, a, b)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class defines a 3-\/D field quantity in the accelerator. The field quantity can be updated at each step. 

\begin{DoxyAuthor}{Author}
Ji Qiang 
\end{DoxyAuthor}


\subsection{Data Type Documentation}
\index{fieldquantclass::fieldquant@{fieldquantclass::fieldquant}}\label{structfieldquantclass_1_1fieldquant}
\Hypertarget{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}
\subsubsection{type fieldquantclass\+::fieldquant}
\begin{DoxyFields}{Data Fields}
\mbox{\Hypertarget{namespacefieldquantclass_a3d25be64f02ec3fd9be9700006e6e4f3}\label{namespacefieldquantclass_a3d25be64f02ec3fd9be9700006e6e4f3}} 
double precision, dimension(:,:,:), pointer&
fieldq&
num field quantity array. \\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_a7e825dc6a0487f44528fad55e632cc70}\label{namespacefieldquantclass_a7e825dc6a0487f44528fad55e632cc70}} 
integer&
nx&
num of mesh points in x and y directions. \\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_a7caab2ebce71f57176a519933b7e2666}\label{namespacefieldquantclass_a7caab2ebce71f57176a519933b7e2666}} 
integer&
nxlocal&
\\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_a400586052c8deb7240b215eee62b89e9}\label{namespacefieldquantclass_a400586052c8deb7240b215eee62b89e9}} 
integer&
ny&
\\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_a3c9290ff97ebcaf272c17ed3975a18e1}\label{namespacefieldquantclass_a3c9290ff97ebcaf272c17ed3975a18e1}} 
integer&
nylocal&
\\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_a6f78161e325887e087580ad729a35d0b}\label{namespacefieldquantclass_a6f78161e325887e087580ad729a35d0b}} 
integer&
nz&
\\
\hline

\mbox{\Hypertarget{namespacefieldquantclass_aa91a76fdf699b94c32a92a2b2fa2451d}\label{namespacefieldquantclass_aa91a76fdf699b94c32a92a2b2fa2451d}} 
integer&
nzlocal&
\\
\hline

\end{DoxyFields}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacefieldquantclass_a0cf12c2453dd024814caca1b9dbbb9a5}\label{namespacefieldquantclass_a0cf12c2453dd024814caca1b9dbbb9a5}} 
\index{fieldquantclass@{fieldquantclass}!ampcyl\_fieldquant@{ampcyl\_fieldquant}}
\index{ampcyl\_fieldquant@{ampcyl\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{ampcyl\_fieldquant()}{ampcyl\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::ampcyl\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{double precision, intent(in)}]{a,  }\item[{double precision, intent(in)}]{b,  }\item[{double precision, intent(in)}]{eps,  }\item[{double precision, intent(in)}]{nkx,  }\item[{double precision, intent(in)}]{nky,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(in)}]{dky,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(out)}]{amp }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a0cf12c2453dd024814caca1b9dbbb9a5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a0cf12c2453dd024814caca1b9dbbb9a5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a735a6d51aabd219f525edeb04b034150}\label{namespacefieldquantclass_a735a6d51aabd219f525edeb04b034150}} 
\index{fieldquantclass@{fieldquantclass}!amplse\_asym@{amplse\_asym}}
\index{amplse\_asym@{amplse\_asym}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{amplse\_asym()}{amplse\_asym()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::amplse\+\_\+asym (\begin{DoxyParamCaption}\item[{double precision}]{a,  }\item[{double precision}]{b,  }\item[{double precision}]{eps,  }\item[{double precision}]{kx,  }\item[{double precision}]{ky }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a735a6d51aabd219f525edeb04b034150_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a8eb7b870ec7c240279076fbb6269ff07}\label{namespacefieldquantclass_a8eb7b870ec7c240279076fbb6269ff07}} 
\index{fieldquantclass@{fieldquantclass}!amplse\_sym@{amplse\_sym}}
\index{amplse\_sym@{amplse\_sym}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{amplse\_sym()}{amplse\_sym()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::amplse\+\_\+sym (\begin{DoxyParamCaption}\item[{double precision}]{a,  }\item[{double precision}]{b,  }\item[{double precision}]{eps,  }\item[{double precision}]{kx,  }\item[{double precision}]{ky }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a8eb7b870ec7c240279076fbb6269ff07_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ac67e15255b5d57fb3c3a29ef79addb63}\label{namespacefieldquantclass_ac67e15255b5d57fb3c3a29ef79addb63}} 
\index{fieldquantclass@{fieldquantclass}!amplsm\_asym@{amplsm\_asym}}
\index{amplsm\_asym@{amplsm\_asym}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{amplsm\_asym()}{amplsm\_asym()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::amplsm\+\_\+asym (\begin{DoxyParamCaption}\item[{double precision}]{a,  }\item[{double precision}]{b,  }\item[{double precision}]{eps,  }\item[{double precision}]{kx,  }\item[{double precision}]{ky }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac67e15255b5d57fb3c3a29ef79addb63_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_aaf0193e68163e6fb2bba0a9477f19cb0}\label{namespacefieldquantclass_aaf0193e68163e6fb2bba0a9477f19cb0}} 
\index{fieldquantclass@{fieldquantclass}!amplsm\_sym@{amplsm\_sym}}
\index{amplsm\_sym@{amplsm\_sym}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{amplsm\_sym()}{amplsm\_sym()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::amplsm\+\_\+sym (\begin{DoxyParamCaption}\item[{double precision}]{a,  }\item[{double precision}]{b,  }\item[{double precision}]{eps,  }\item[{double precision}]{kx,  }\item[{double precision}]{ky }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_aaf0193e68163e6fb2bba0a9477f19cb0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ac5166a3094bb6567db04903c1f43e4b6}\label{namespacefieldquantclass_ac5166a3094bb6567db04903c1f43e4b6}} 
\index{fieldquantclass@{fieldquantclass}!ampslab\_fieldquant@{ampslab\_fieldquant}}
\index{ampslab\_fieldquant@{ampslab\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{ampslab\_fieldquant()}{ampslab\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::ampslab\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{double precision, intent(in)}]{a,  }\item[{double precision, intent(in)}]{b,  }\item[{double precision, intent(in)}]{eps,  }\item[{double precision, intent(in)}]{nkx,  }\item[{double precision, intent(in)}]{nky,  }\item[{double precision, dimension(\+:), intent(in)}]{dkx,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(in)}]{dky,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(out)}]{amp }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac5166a3094bb6567db04903c1f43e4b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac5166a3094bb6567db04903c1f43e4b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a491cfca134ed1bb2dfc47d6de7fdd972}\label{namespacefieldquantclass_a491cfca134ed1bb2dfc47d6de7fdd972}} 
\index{fieldquantclass@{fieldquantclass}!calclfs@{calclfs}}
\index{calclfs@{calclfs}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{calclfs()}{calclfs()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::calclfs (\begin{DoxyParamCaption}\item[{double precision}]{s,  }\item[{double precision}]{a,  }\item[{double precision}]{b,  }\item[{double precision}]{eps }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacefieldquantclass_a491cfca134ed1bb2dfc47d6de7fdd972_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a491cfca134ed1bb2dfc47d6de7fdd972_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a765f0fc87c405fa965c6c966794db11c}\label{namespacefieldquantclass_a765f0fc87c405fa965c6c966794db11c}} 
\index{fieldquantclass@{fieldquantclass}!calcr0@{calcr0}}
\index{calcr0@{calcr0}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{calcr0()}{calcr0()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::calcr0 (\begin{DoxyParamCaption}\item[{double precision}]{s,  }\item[{double precision}]{a,  }\item[{double precision}]{b }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a765f0fc87c405fa965c6c966794db11c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a02f323941fc76278b26a3aa06fa3bbdd}\label{namespacefieldquantclass_a02f323941fc76278b26a3aa06fa3bbdd}} 
\index{fieldquantclass@{fieldquantclass}!construct\_fieldquant@{construct\_fieldquant}}
\index{construct\_fieldquant@{construct\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{construct\_fieldquant()}{construct\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::construct\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(out)}]{this,  }\item[{integer, intent(in)}]{innx,  }\item[{integer, intent(in)}]{inny,  }\item[{integer, intent(in)}]{innz,  }\item[{type (compdom), intent(in)}]{geom,  }\item[{type (pgrid2d), intent(in)}]{grid }\end{DoxyParamCaption})}



Initialize field class. 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a02f323941fc76278b26a3aa06fa3bbdd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacefieldquantclass_a02f323941fc76278b26a3aa06fa3bbdd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a773b62d57c290818337131902b979b43}\label{namespacefieldquantclass_a773b62d57c290818337131902b979b43}} 
\index{fieldquantclass@{fieldquantclass}!csrwaketr\_fieldquant@{csrwaketr\_fieldquant}}
\index{csrwaketr\_fieldquant@{csrwaketr\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{csrwaketr\_fieldquant()}{csrwaketr\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::csrwaketr\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nx,  }\item[{real$\ast$8}]{r0,  }\item[{real$\ast$8}]{ptmin,  }\item[{real$\ast$8}]{hx,  }\item[{real$\ast$8}]{blength,  }\item[{real$\ast$8, dimension(nx)}]{rhonew,  }\item[{}]{rh }\end{DoxyParamCaption})}



new version of the csrwake calculation. this subroutine calculate the 1d csr wakefield including entrance, stead-\/state, and transitions effects here, hx, rho,...are in real unit. the return ezwake is V/m 

\begin{DoxyAuthor}{Author}
J. Q. 11/3/08 
\end{DoxyAuthor}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a773b62d57c290818337131902b979b43_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ac3c0238f350487871fdbe6a84bcdfc2e}\label{namespacefieldquantclass_ac3c0238f350487871fdbe6a84bcdfc2e}} 
\index{fieldquantclass@{fieldquantclass}!csrwaketrigf\_fieldquant@{csrwaketrigf\_fieldquant}}
\index{csrwaketrigf\_fieldquant@{csrwaketrigf\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{csrwaketrigf\_fieldquant()}{csrwaketrigf\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::csrwaketrigf\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nx,  }\item[{real$\ast$8}]{r0,  }\item[{real$\ast$8}]{ptmin,  }\item[{real$\ast$8}]{hx,  }\item[{real$\ast$8}]{blength,  }\item[{real$\ast$8, dimension(nx)}]{rhonew }\end{DoxyParamCaption})}



This subroutine calculates the 1d csr wakefield including entrance, stead-\/state, and transitions effects. Here, hx, rho,...are in real units. The return ezwake is in V! /m. The current version uses I\+GF corresponding to the four cases ! of Saldin et al. 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac3c0238f350487871fdbe6a84bcdfc2e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac3c0238f350487871fdbe6a84bcdfc2e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a4e8922c1e25eef99306f4001c7289ba0}\label{namespacefieldquantclass_a4e8922c1e25eef99306f4001c7289ba0}} 
\index{fieldquantclass@{fieldquantclass}!destruct\_fieldquant@{destruct\_fieldquant}}
\index{destruct\_fieldquant@{destruct\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{destruct\_fieldquant()}{destruct\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::destruct\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(out)}]{this }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a4e8922c1e25eef99306f4001c7289ba0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ac9b2b94f5051c235120e16bd55e0148d}\label{namespacefieldquantclass_ac9b2b94f5051c235120e16bd55e0148d}} 
\index{fieldquantclass@{fieldquantclass}!dispeqcyl\_fieldquant@{dispeqcyl\_fieldquant}}
\index{dispeqcyl\_fieldquant@{dispeqcyl\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{dispeqcyl\_fieldquant()}{dispeqcyl\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::dispeqcyl\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{double precision, intent(in)}]{a,  }\item[{double precision, intent(in)}]{b,  }\item[{double precision, intent(in)}]{eps,  }\item[{double precision, intent(in)}]{nkx,  }\item[{double precision, intent(in)}]{nky,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(out)}]{dky }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac9b2b94f5051c235120e16bd55e0148d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac9b2b94f5051c235120e16bd55e0148d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a362a63ffd1dbce47680a0224d88552c7}\label{namespacefieldquantclass_a362a63ffd1dbce47680a0224d88552c7}} 
\index{fieldquantclass@{fieldquantclass}!dispeqslab\_fieldquant@{dispeqslab\_fieldquant}}
\index{dispeqslab\_fieldquant@{dispeqslab\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{dispeqslab\_fieldquant()}{dispeqslab\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::dispeqslab\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{double precision, intent(in)}]{a,  }\item[{double precision, intent(in)}]{b,  }\item[{double precision, intent(in)}]{eps,  }\item[{double precision, intent(in)}]{dlx,  }\item[{double precision, intent(in)}]{nkx,  }\item[{double precision, intent(in)}]{nky,  }\item[{double precision, dimension(\+:), intent(out)}]{dkx,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(out)}]{dky }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a362a63ffd1dbce47680a0224d88552c7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a362a63ffd1dbce47680a0224d88552c7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a80dd0228de4fecabda6f6696b098a11f}\label{namespacefieldquantclass_a80dd0228de4fecabda6f6696b098a11f}} 
\index{fieldquantclass@{fieldquantclass}!dwakeconv\_fieldquant@{dwakeconv\_fieldquant}}
\index{dwakeconv\_fieldquant@{dwakeconv\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{dwakeconv\_fieldquant()}{dwakeconv\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::dwakeconv\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nz,  }\item[{double precision, dimension(nz), intent(in)}]{weightz,  }\item[{double precision, intent(in)}]{hz,  }\item[{double precision, dimension(nz), intent(in)}]{kern,  }\item[{double precision, dimension(nz), intent(out)}]{lam }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a80dd0228de4fecabda6f6696b098a11f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a80dd0228de4fecabda6f6696b098a11f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a990a046cc996cb957a94c4995bfe803a}\label{namespacefieldquantclass_a990a046cc996cb957a94c4995bfe803a}} 
\index{fieldquantclass@{fieldquantclass}!dwakefield\_fieldquant@{dwakefield\_fieldquant}}
\index{dwakefield\_fieldquant@{dwakefield\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{dwakefield\_fieldquant()}{dwakefield\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::dwakefield\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nx,  }\item[{integer, intent(in)}]{Ny,  }\item[{integer, intent(in)}]{Nz,  }\item[{double precision, intent(in)}]{hx,  }\item[{double precision, intent(in)}]{hy,  }\item[{double precision, intent(in)}]{hz,  }\item[{double precision, dimension(\+:,\+:,\+:), intent(in)}]{chgdens,  }\item[{}]{dexwak }\end{DoxyParamCaption})}



This routine computes the root of the function that is evaluated ! in the subroutine \textquotesingle{}funcd\textquotesingle{}. It is based on the subroutine \textquotesingle{}root\textquotesingle{} of Numerical Recipes 9.\+4, which makes use of a Newton-\/\+Raphson method with root bracketing. It has been modified to handle the two bra! cket endpoints carefully. The routine searches for a root in the inter! val \mbox{[}x1,x2\mbox{]} with a tolerance given by \textquotesingle{}xacc\textquotesingle{}, and returns this value as \textquotesingle{}rtsafe\textquotesingle{}. The maximum number of iterations allowed is \textquotesingle{}maxit\textquotesingle{}! . C.\+E.\+M. 

This routine evaluates the function whose root produces the retarded angle psi that is required for evaluating the C\+SR kernel in Case D of Saldin et al. The value of the function is output as \textquotesingle{}f\textquotesingle{}, and its derivative is output as \textquotesingle{}derivf\textquotesingle{}. C.\+E.\+M. Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a990a046cc996cb957a94c4995bfe803a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a990a046cc996cb957a94c4995bfe803a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a3979aaa9ea17b446b00cd5477dfd354e}\label{namespacefieldquantclass_a3979aaa9ea17b446b00cd5477dfd354e}} 
\index{fieldquantclass@{fieldquantclass}!func1@{func1}}
\index{func1@{func1}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{func1()}{func1()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::func1 (\begin{DoxyParamCaption}\item[{double precision}]{x,  }\item[{double precision}]{c1,  }\item[{double precision}]{c2 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a3979aaa9ea17b446b00cd5477dfd354e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a1758703e79afc95b20c7fd7261fa4afe}\label{namespacefieldquantclass_a1758703e79afc95b20c7fd7261fa4afe}} 
\index{fieldquantclass@{fieldquantclass}!func2@{func2}}
\index{func2@{func2}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{func2()}{func2()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::func2 (\begin{DoxyParamCaption}\item[{double precision}]{x,  }\item[{double precision}]{c1,  }\item[{double precision}]{c3 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a1758703e79afc95b20c7fd7261fa4afe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a5d4c07c22ffea0330d90b66e590b24a8}\label{namespacefieldquantclass_a5d4c07c22ffea0330d90b66e590b24a8}} 
\index{fieldquantclass@{fieldquantclass}!get\_fieldquant@{get\_fieldquant}}
\index{get\_fieldquant@{get\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{get\_fieldquant()}{get\_fieldquant()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::get\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(in)}]{this,  }\item[{integer, intent(in)}]{i,  }\item[{integer, intent(in)}]{j,  }\item[{integer, intent(in)}]{k }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=333pt]{namespacefieldquantclass_a5d4c07c22ffea0330d90b66e590b24a8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a2c0b0d0301e9ae5ccd8b2273ffc95ff3}\label{namespacefieldquantclass_a2c0b0d0301e9ae5ccd8b2273ffc95ff3}} 
\index{fieldquantclass@{fieldquantclass}!getglb\_fieldquant@{getglb\_fieldquant}}
\index{getglb\_fieldquant@{getglb\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{getglb\_fieldquant()}{getglb\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::getglb\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(in)}]{this,  }\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(out)}]{temp }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacefieldquantclass_a2c0b0d0301e9ae5ccd8b2273ffc95ff3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_aa439599c2570610c1c2e0bfacc135603}\label{namespacefieldquantclass_aa439599c2570610c1c2e0bfacc135603}} 
\index{fieldquantclass@{fieldquantclass}!getlcgrid\_fieldquant@{getlcgrid\_fieldquant}}
\index{getlcgrid\_fieldquant@{getlcgrid\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{getlcgrid\_fieldquant()}{getlcgrid\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::getlcgrid\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(in)}]{this,  }\item[{integer, intent(out)}]{nxlc,  }\item[{integer, intent(out)}]{nylc,  }\item[{integer, intent(out)}]{nzlc }\end{DoxyParamCaption})}

\mbox{\Hypertarget{namespacefieldquantclass_a1424ab249c01287bbfe998370d2c5703}\label{namespacefieldquantclass_a1424ab249c01287bbfe998370d2c5703}} 
\index{fieldquantclass@{fieldquantclass}!gradeb\_fieldquant@{gradeb\_fieldquant}}
\index{gradeb\_fieldquant@{gradeb\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{gradeb\_fieldquant()}{gradeb\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::gradeb\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{innx,  }\item[{integer, intent(in)}]{inny,  }\item[{integer, intent(in)}]{innz,  }\item[{}]{temppotent,  }\item[{type (compdom), intent(in)}]{ptsgeom,  }\item[{type (pgrid2d), intent(in)}]{grid,  }\item[{integer, intent(in)}]{Flagbc,  }\item[{double precision, intent(in)}]{gammaz,  }\item[{integer, intent(in)}]{Flag\+Image,  }\item[{}]{egxout,  }\item[{}]{egyout,  }\item[{}]{egzout,  }\item[{}]{bgxout,  }\item[{}]{bgyout,  }\item[{}]{bgzout }\end{DoxyParamCaption})}



find the E and B fields in the lab frame from the potential on the grid of beam frame. 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a1424ab249c01287bbfe998370d2c5703_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a1424ab249c01287bbfe998370d2c5703_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a32715398e47b9a73bd6cde1ae980e0a3}\label{namespacefieldquantclass_a32715398e47b9a73bd6cde1ae980e0a3}} 
\index{fieldquantclass@{fieldquantclass}!greenf1tintnew2@{greenf1tintnew2}}
\index{greenf1tintnew2@{greenf1tintnew2}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{greenf1tintnew2()}{greenf1tintnew2()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::greenf1tintnew2 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{nx,  }\item[{integer, intent(in)}]{ny,  }\item[{integer, intent(in)}]{nz,  }\item[{integer, intent(in)}]{nsizez,  }\item[{integer, intent(in)}]{nsizey,  }\item[{integer, intent(in)}]{nsizexy,  }\item[{}]{nsizey }\end{DoxyParamCaption})}



green function for extended array. 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a32715398e47b9a73bd6cde1ae980e0a3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a32715398e47b9a73bd6cde1ae980e0a3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a25df6116d62bb56b5711333426dcd74d}\label{namespacefieldquantclass_a25df6116d62bb56b5711333426dcd74d}} 
\index{fieldquantclass@{fieldquantclass}!greenf1tintshift2@{greenf1tintshift2}}
\index{greenf1tintshift2@{greenf1tintshift2}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{greenf1tintshift2()}{greenf1tintshift2()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::greenf1tintshift2 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{nx,  }\item[{integer, intent(in)}]{ny,  }\item[{integer, intent(in)}]{nz,  }\item[{integer, intent(in)}]{nsizez,  }\item[{integer, intent(in)}]{nsizey,  }\item[{integer, intent(in)}]{nsizexy,  }\item[{}]{nsiz }\end{DoxyParamCaption})}



green function for extended array. 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a25df6116d62bb56b5711333426dcd74d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a25df6116d62bb56b5711333426dcd74d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a7431c26c185c399c546e1ac54043bad4}\label{namespacefieldquantclass_a7431c26c185c399c546e1ac54043bad4}} 
\index{fieldquantclass@{fieldquantclass}!icsrcasea@{icsrcasea}}
\index{icsrcasea@{icsrcasea}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{icsrcasea()}{icsrcasea()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::icsrcasea (\begin{DoxyParamCaption}\item[{double precision}]{phih,  }\item[{double precision}]{ssh,  }\item[{double precision}]{xk2 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a7431c26c185c399c546e1ac54043bad4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ac6ac81d1607e424c294650bb3f89aa5c}\label{namespacefieldquantclass_ac6ac81d1607e424c294650bb3f89aa5c}} 
\index{fieldquantclass@{fieldquantclass}!icsrcaseb@{icsrcaseb}}
\index{icsrcaseb@{icsrcaseb}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{icsrcaseb()}{icsrcaseb()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::icsrcaseb (\begin{DoxyParamCaption}\item[{double precision}]{ssh,  }\item[{double precision}]{xk2 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ac6ac81d1607e424c294650bb3f89aa5c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a85aac5a4f515439e4263b24518d8c9dc}\label{namespacefieldquantclass_a85aac5a4f515439e4263b24518d8c9dc}} 
\index{fieldquantclass@{fieldquantclass}!icsrcasec@{icsrcasec}}
\index{icsrcasec@{icsrcasec}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{icsrcasec()}{icsrcasec()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::icsrcasec (\begin{DoxyParamCaption}\item[{double precision}]{phimh,  }\item[{double precision}]{xxbarh,  }\item[{double precision}]{ssh,  }\item[{double precision}]{xk2 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a85aac5a4f515439e4263b24518d8c9dc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a6e7b51293ed012f0a90b5de96a3cef05}\label{namespacefieldquantclass_a6e7b51293ed012f0a90b5de96a3cef05}} 
\index{fieldquantclass@{fieldquantclass}!icsrcased@{icsrcased}}
\index{icsrcased@{icsrcased}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{icsrcased()}{icsrcased()}}
{\footnotesize\ttfamily double precision function fieldquantclass\+::icsrcased (\begin{DoxyParamCaption}\item[{double precision}]{xxbarh,  }\item[{double precision}]{psimax,  }\item[{double precision}]{ssh,  }\item[{double precision}]{xk2,  }\item[{double precision}]{epstol,  }\item[{integer}]{Nmax }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a6e7b51293ed012f0a90b5de96a3cef05_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_aae4177005bffdb768a50a98b860c111a}\label{namespacefieldquantclass_aae4177005bffdb768a50a98b860c111a}} 
\index{fieldquantclass@{fieldquantclass}!openbc3dnew@{openbc3dnew}}
\index{openbc3dnew@{openbc3dnew}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{openbc3dnew()}{openbc3dnew()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::openbc3dnew (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{innx,  }\item[{integer, intent(in)}]{inny,  }\item[{integer, intent(in)}]{innz,  }\item[{double precision, dimension(innx,inny,innz), intent(inout)}]{rho,  }\item[{double precision, intent(in)}]{hx,  }\item[{double precision, intent(in)}]{hy,  }\item[{double precision, intent(in)}]{hz,  }\item[{integer, intent(in)}]{nxpylc2,  }\item[{integer, intent(in)}]{nypzlc2,  }\item[{integer, intent(in)}]{myidz,  }\item[{integer, intent(in)}]{myidy,  }\item[{integer, intent(in)}]{npz,  }\item[{integer, intent(in)}]{npy,  }\item[{integer, intent(in)}]{commrow,  }\item[{integer, intent(in)}]{commcol,  }\item[{integer, intent(in)}]{comm2d,  }\item[{integer, dimension(0\+:npz-\/1), intent(in)}]{pztable,  }\item[{integer, dimension(0\+:npy-\/1), intent(in)}]{pytable,  }\item[{integer, dimension(0\+:npz-\/1), intent(in)}]{ypzstable,  }\item[{integer, dimension(0\+:npy-\/1), intent(in)}]{xpystable,  }\item[{integer, intent(in)}]{inxglb,  }\item[{integer, intent(in)}]{inyglb,  }\item[{integer, intent(in)}]{inzglb,  }\item[{}]{rho\+Img,  }\item[{integer, intent(in)}]{flag\+Image,  }\item[{double precision, intent(in)}]{zshift }\end{DoxyParamCaption})}



Solving Poisson\textquotesingle{}s equation with open B\+Cs. 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_aae4177005bffdb768a50a98b860c111a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_aae4177005bffdb768a50a98b860c111a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_ae02f70d677d4bedfa6e41bd6cf33d612}\label{namespacefieldquantclass_ae02f70d677d4bedfa6e41bd6cf33d612}} 
\index{fieldquantclass@{fieldquantclass}!psiroot@{psiroot}}
\index{psiroot@{psiroot}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{psiroot()}{psiroot()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::psiroot (\begin{DoxyParamCaption}\item[{real$\ast$8}]{r0,  }\item[{real$\ast$8}]{xx,  }\item[{real$\ast$8}]{deltas,  }\item[{real$\ast$8}]{psi,  }\item[{real$\ast$8}]{eps,  }\item[{integer}]{Nmax }\end{DoxyParamCaption})}



find the psi in equation 12 of Stupakov and Emma\textquotesingle{}s paper 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_ae02f70d677d4bedfa6e41bd6cf33d612_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a2d6cd3fb8b4d962adbd4206a5fbd13ce}\label{namespacefieldquantclass_a2d6cd3fb8b4d962adbd4206a5fbd13ce}} 
\index{fieldquantclass@{fieldquantclass}!set\_fieldquant@{set\_fieldquant}}
\index{set\_fieldquant@{set\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{set\_fieldquant()}{set\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::set\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(inout)}]{this,  }\item[{integer, intent(in)}]{innx,  }\item[{integer, intent(in)}]{inny,  }\item[{integer, intent(in)}]{innz,  }\item[{type (compdom), intent(in)}]{geom,  }\item[{type (pgrid2d), intent(in)}]{grid,  }\item[{integer, intent(in)}]{nprx,  }\item[{integer, intent(in)}]{npry }\end{DoxyParamCaption})}



set field quantity. 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a2d6cd3fb8b4d962adbd4206a5fbd13ce_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a2d6cd3fb8b4d962adbd4206a5fbd13ce_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a05318a0c571b3210e31af48028673474}\label{namespacefieldquantclass_a05318a0c571b3210e31af48028673474}} 
\index{fieldquantclass@{fieldquantclass}!setval\_fieldquant@{setval\_fieldquant}}
\index{setval\_fieldquant@{setval\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{setval\_fieldquant()}{setval\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::setval\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(out)}]{this,  }\item[{integer, intent(in)}]{i,  }\item[{integer, intent(in)}]{j,  }\item[{integer, intent(in)}]{k,  }\item[{double precision, intent(in)}]{value }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacefieldquantclass_a05318a0c571b3210e31af48028673474_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a06d0461c3c52859b9fa8b0c4d5f0db46}\label{namespacefieldquantclass_a06d0461c3c52859b9fa8b0c4d5f0db46}} 
\index{fieldquantclass@{fieldquantclass}!update3otnew\_fieldquant@{update3otnew\_fieldquant}}
\index{update3otnew\_fieldquant@{update3otnew\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{update3otnew\_fieldquant()}{update3otnew\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::update3otnew\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{namespacefieldquantclass_structfieldquantclass_1_1fieldquant}{fieldquant}}), intent(inout)}]{this,  }\item[{}]{source,  }\item[{type (compdom), intent(in)}]{fldgeom,  }\item[{type (pgrid2d), intent(in)}]{grid,  }\item[{integer, intent(in)}]{nxlc }\end{DoxyParamCaption})}



update potential (solving Possion\textquotesingle{}s equation) with 3D isolated boundary conditions. Here, image charge potential along z also calculated 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a06d0461c3c52859b9fa8b0c4d5f0db46_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a06d0461c3c52859b9fa8b0c4d5f0db46_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_a61fa5f8980736fbc19fa50224214727b}\label{namespacefieldquantclass_a61fa5f8980736fbc19fa50224214727b}} 
\index{fieldquantclass@{fieldquantclass}!wakefield\_fieldquant@{wakefield\_fieldquant}}
\index{wakefield\_fieldquant@{wakefield\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{wakefield\_fieldquant()}{wakefield\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::wakefield\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nz,  }\item[{double precision, dimension(nz), intent(in)}]{xwakez,  }\item[{double precision, dimension(nz), intent(in)}]{ywakez,  }\item[{double precision, dimension(nz,2), intent(in)}]{recvdensz,  }\item[{double precision, dimension(nz), intent(out)}]{exwake }\end{DoxyParamCaption})}



longitudinal and transverse wakefield 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a61fa5f8980736fbc19fa50224214727b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_a61fa5f8980736fbc19fa50224214727b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacefieldquantclass_afc918d38222797f1f06903259e48461b}\label{namespacefieldquantclass_afc918d38222797f1f06903259e48461b}} 
\index{fieldquantclass@{fieldquantclass}!wakereadin\_fieldquant@{wakereadin\_fieldquant}}
\index{wakereadin\_fieldquant@{wakereadin\_fieldquant}!fieldquantclass@{fieldquantclass}}
\subsubsection{\texorpdfstring{wakereadin\_fieldquant()}{wakereadin\_fieldquant()}}
{\footnotesize\ttfamily subroutine fieldquantclass\+::wakereadin\+\_\+fieldquant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{Nz,  }\item[{double precision, dimension(nz), intent(in)}]{xwakez,  }\item[{double precision, dimension(nz), intent(in)}]{ywakez,  }\item[{double precision, dimension(nz,2), intent(in)}]{recvdensz,  }\item[{}]{exwak }\end{DoxyParamCaption})}



longitudinal and transverse wakefield on a beam using the readin longitudinal and transverse wake functions 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_afc918d38222797f1f06903259e48461b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacefieldquantclass_afc918d38222797f1f06903259e48461b_icgraph}
\end{center}
\end{figure}
